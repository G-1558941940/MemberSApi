<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--userMapper空间-->
<mapper namespace="com.member.api.mappers.second.NopayingRecordMapper">


    <select id="PayingRecord" resultType="com.member.api.entity.PayRecord">
        SELECT
	o."redcordId",
	o.carnumber,
	o.intime,
	o.outtime,
	P.payamount / 100.0 AS payamount,
	P.paidamount / 100.0 AS paidamount,
	P.paymenttype,
	P.chargetime,
	P.close_optername,
	P.close_accountno,
	P.parking_name,
	round( date_part( 'epoch', o.outtime - o.intime ) :: NUMERIC / 60 ) AS parktime
FROM
	outparking AS o
	LEFT JOIN p_record_charge AS P ON P.intime = o.intime
WHERE
	o.carnumber IS NOT NULL
	AND P.intime IS NULL
	AND parking_name IS NOT NULL;
    </select>
</mapper>
